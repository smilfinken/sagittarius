<link media="print" type="text/css" rel="stylesheet" href="/public/stylesheets/results.css"/>

<div>
	<h2 class="left">
		${competition.name}
	</h2>
</div>
<div>
	<h2 class="right">
		${competition.getDate()}
	</h2>
</div>

<div class="content">
	%{
	int totalHits;
	int totalTargets;
	int totalPoints;
	int place = 1;
	int count = 1;
	}%
	<table>
		%{
		if (results.size() > 0) {
		String previousClass = "";
		for(entry in results){
		if (entry.results != null && entry.results.size() == competition.stages.size()) {
		if (!entry.getDivision().equals(previousClass)){
		place = 1;
		}%
		<thead>
		<th class="left">
			Klass ${entry.getDivision()}
		</th>
		<th class="center">
			Stationer
		</th>
		<th class="right">
			Totalt
		</th>
		</thead>
		%{
		}
		previousClass = entry.getDivision();
		}%
		<tr>
			<td class="competitor">
				<span class="place">${place++}</span> <span class="name">${entry.getFullName()}</span>
			</td>
			<td>
				%{
				totalHits = 0;
				totalTargets = 0;
				totalPoints = 0;
				count = 1;
				for(result in entry.results){
				totalHits += result.hits;
				totalTargets += result.targets;
				totalPoints += result.points;
				}%
				${result.hits}/${result.targets}#{if result.points > 0} (${result.points})#{/if}#{if count++ < entry.results.size()}, #{/if}
				%{
				}
				}%
			</td>
			<td>
				#{if competition.scoringType.sumPointsAndTargets() == true}
				<span class="sum">${totalHits + totalTargets}</span> (${totalPoints})
				#{/if}
				#{else}
				<span class="sum">${totalHits}/${totalTargets}</span> (${totalPoints})
				#{/else}
			</td>
		</tr>
		%{
		}
		}
		}
		}%
	</table>
</div>